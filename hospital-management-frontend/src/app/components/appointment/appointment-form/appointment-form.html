<div class="form-container">
  <nav class="navbar">
    <h1>{{ isEditMode ? 'Edit Appointment' : 'New Appointment' }}</h1>
    <button class="btn-back" (click)="cancel()">Back to List</button>
  </nav>

  <div class="form-content">
    <div class="form-card">
      <h2>{{ isEditMode ? 'Update Appointment' : 'Schedule New Appointment' }}</h2>

      <div class="error" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <form (ngSubmit)="saveAppointment()">
        
        <!-- PATIENT ROLE FORM -->
        <div *ngIf="isPatientRole()">
          <div class="form-group">
            <label>Patient Name *</label>
            <input type="text" [(ngModel)]="patientDetails.name" name="patientName" placeholder="Enter patient name" required>
          </div>

          <div class="form-group">
            <label>Phone *</label>
            <input type="tel" [(ngModel)]="patientDetails.phone" name="patientPhone" placeholder="Enter phone number" required>
          </div>

          <div class="form-group">
            <label>Age *</label>
            <input type="number" [(ngModel)]="patientDetails.age" name="patientAge" placeholder="Enter age" required>
          </div>

         <div class="form-group">
  <label>Blood Group *</label>
  <select [(ngModel)]="patientDetails.bloodGroup" name="patientBloodGroup" required>
    <option value="">Select Blood Group</option>
    <option value="A+">A+</option>
    <option value="A-">A-</option>
    <option value="B+">B+</option>
    <option value="B-">B-</option>
    <option value="AB+">AB+</option>
    <option value="AB-">AB-</option>
    <option value="O+">O+</option>
    <option value="O-">O-</option>
  </select>
</div>

          <div class="form-group">
            <label>Select Specialist *</label>
            <select [(ngModel)]="appointment.doctorId" name="doctorId" required>
              <option value="0">Select Specialist</option>
              <option *ngFor="let doctor of doctors" [value]="doctor.doctorId">
                {{ doctor.doctorName }} ({{ doctor.specialization }})
              </option>
            </select>
          </div>
        </div>

        <!-- ADMIN/DOCTOR ROLE FORM -->
        <div *ngIf="!isPatientRole()">
          <div class="form-group">
            <label>Patient *</label>
            <select [(ngModel)]="appointment.patientId" name="patientId" required>
              <option value="0">Select Patient</option>
              <option *ngFor="let patient of patients" [value]="patient.patientId">
                {{ patient.patientName }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label>Doctor *</label>
            <select [(ngModel)]="appointment.doctorId" name="doctorId" required>
              <option value="0">Select Doctor</option>
              <option *ngFor="let doctor of doctors" [value]="doctor.doctorId">
                {{ doctor.doctorName }} - {{ doctor.specialization }}
              </option>
            </select>
          </div>
        </div>

        <!-- COMMON FIELDS FOR ALL ROLES -->
        <div class="form-group">
          <label>Appointment Date & Time *</label>
          <input 
            type="datetime-local" 
            [(ngModel)]="appointment.appointmentDate" 
            name="appointmentDate"
            required>
        </div>

       <div class="form-group">
  <label>Status *</label>
  <select [(ngModel)]="appointment.status" name="status" required>
    <option value="SCHEDULED">Scheduled</option>
    <option value="CONFIRMED">Confirmed</option>
    <option value="COMPLETED">Completed</option>
    <option value="CANCELLED">Cancelled</option>
  </select>
</div>
        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="cancel()">Cancel</button>
          <button type="submit" class="btn-save">{{ isEditMode ? 'Update' : 'Schedule' }}</button>
        </div>
      </form>
    </div>
  </div>
</div>